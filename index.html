<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>KeyWord搜索量 + 气温 + 搜索 + 最近一周(排序) + 重试</title>

  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js" defer></script>
  
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.2.1" defer></script>

  <style>
    /* CSS 布局部分 (已修复) */
    * {
      box-sizing: border-box;
    }
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: sans-serif;
      overflow: hidden; 
    }
    .sidebar-toggle {
      position: fixed; left: 0; top: 0;
      background: #3b5998; color: #fff;
      padding: 8px 12px; border: none; cursor: pointer;
      z-index: 9999;
    }
    .sidebar {
      position: fixed; left: 0; top: 0;
      width: 280px; height: 100vh;
      background: #fafafa;
      box-shadow: 2px 0 5px rgba(0,0,0,0.2);
      transform: translateX(-100%);
      transition: transform 0.3s;
      padding: 10px;
      overflow-y: auto;
      z-index: 9998;
      padding-top: 50px;
    }
    .sidebar.active {
      transform: translateX(0);
    }
    .sidebar h3 {
      margin: 0 0 6px 0;
      display: flex; align-items: center; gap: 4px;
    }
    .search-row {
      display: flex; align-items: center; gap: 4px;
      margin-bottom: 8px;
    }
    .search-row input {
      flex: 1; padding: 4px 6px; font-size: 14px;
    }
    .search-row button {
      font-size: 12px; cursor: pointer; padding: 4px 8px;
    }
    .group-panel {
      margin-bottom: 6px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    summary {
      background: #eee; padding: 4px 6px; font-weight: bold; cursor: pointer;
      display: flex; align-items: center; justify-content: space-between;
    }
    summary button {
      font-size: 12px; cursor: pointer; margin-left: 8px;
    }
    label {
      display: block;
      margin-left: 10px;
    }
    #noMatchMsg {
      display: none; color: #999; margin-top: 8px;
    }
    .main-area {
      margin-left: 60px;
      display: flex;
      flex-direction: column;
      height: 100vh; 
    }
    .topbar {
      background: #f0f0f0; padding: 8px;
      display: flex; align-items: center; gap: 6px;
      flex-shrink: 0; 
    }
    .topbar h1 {
      margin: 0; 
      flex: 1;
    }
    .chart-container {
      flex: 1; 
      position: relative; 
      overflow: auto; 
      min-height: 0; 
    }
    #myChart {
      min-width: 1200px;
      min-height: 600px;
    }
  </style>
</head>

<body>
  <button class="sidebar-toggle" id="toggleSidebar">≡</button>

  <div class="sidebar" id="sidebar">
    <h3>
      分组
      <button id="globalAllBtn">全选</button>
      <button id="globalNoneBtn">全不选</button>
    </h3>
    <div class="search-row">
      <input type="text" id="searchInput" placeholder="搜索分组或关键词...">
      <button id="btnClearSearch">X</button>
    </div>
    <div id="groupContainer"></div>
    <div id="noMatchMsg">未找到匹配项</div>
  </div>

  <div class="main-area">
    <div class="topbar">
      <h1>KeyWord搜索量 + 气温 + 搜索 + 最近一周(排序) + 重试</h1>
      <button id="btnRefresh">刷新数据</button>
      <label>开始周:</label>
      <select id="startWeek"></select>
      <label>结束周:</label>
      <select id="endWeek"></select>
      <button id="btnFilter">更新区间</button>
    </div>
    <div class="chart-container">
      <canvas id="myChart"></canvas>
    </div>
  </div>

  <script>
    /* * ===============================================================
     * * 脚本部分 (已清除所有JS拼写错误)
     * * ===============================================================
     */

    /***************************************************************
     * 1) CSV链接
     ***************************************************************/
    const KEYWORD_CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSBce7q_OMpfcVP7rW9Qbtp9jaRpcW7MY4hzaXtvrOlZh0qrwlMMqJupAUkDzYkqJ5DJGBAlHUbXU_0/pub?output=csv";
    const AVG_TEMP_CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQsIu0jYheUb5YE9-D0SwtL6FxkTjFwEgWaH56NdOyqYfNkcZLJGM2xp9T2wPLcF5lYFBZ3UCa7eiaj/pub?output=csv";
    const MAX_TEMP_CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSnxZTyYhuMkeM0D0ystDYz2w0tQJZDN5yyxoy51Rl8yA23j-7nSm3gOC4SeAJnhB9_iHT_mTIVzZlR/pub?output=csv";

    /***************************************************************
     * 2) 全局变量
     ***************************************************************/
    let chart;
    let labelsAll = [];
    let groupsData = {};   
    let globalGroupsRaw = {}; 
    let tempAvgData = [];
    let tempMaxData = [];

    /***************************************************************
     * 重试机制
     ***************************************************************/
    function parseCSVWithRetry(url, maxAttempts = 3) {
      return new Promise((resolve, reject) => {
        let attempts = 0;
        function attemptFetch() {
          attempts++;
          Papa.parse(url, {
            download: true,
            complete: res => resolve(res),
            error: err => {
              console.warn(`[WARN] 第${attempts}次请求失败:`, err);
              if (attempts < maxAttempts) {
                setTimeout(attemptFetch, 1000 * attempts); 
              } else {
                reject(err);
              }
            }
          });
        }
        attemptFetch();
      });
    }

    /***************************************************************
     * A. 解析 关键词 CSV (处理逗号和N/A)
     ***************************************************************/
    function fetchKeywordCSV() {
      return parseCSVWithRetry(KEYWORD_CSV_URL, 3);
    }

    function convertWideToLong(raw2D) {
      const rowGroup = raw2D[0];
      const rowKeyword = raw2D[1];
      const out = [];

      const numCols = rowKeyword.length; 

      for (let r = 2; r < raw2D.length; r++) {
        const row = raw2D[r];
        if (!row || !row[0]) continue; 
        const fileName = row[0];
        
        let currentGroup = ""; 

        for (let c = 1; c < numCols; c++) { 
          
          if (rowGroup[c]) {
            currentGroup = rowGroup[c].trim();
          }
          const grp = currentGroup;
          const kw = rowKeyword[c] ? rowKeyword[c].trim() : "";

          if (!grp || !kw) {
            continue;
          }
          
          const rawStr = (row[c] || "").trim();
          let val = NaN;
          if (rawStr) {
            val = parseFloat(rawStr.replace(/,/g, ''));
          }

          out.push({ week_label: fileName, group: grp, keyword: kw, value: val });
        }
      }
      console.log("[DEBUG] convertWideToLong output:", out); 
      return out;
    }

    function processLongRows(longData) {
      const setWeeks = new Set();
      longData.forEach(it => setWeeks.add(it.week_label));
      const weeks = Array.from(setWeeks).sort();

      const gData = {};
      const count = weeks.length;
      longData.forEach(it => {
        const w = it.week_label;
        const g = it.group;
        const k = it.keyword;
        const v = it.value;

        if (!g || !k) {
          console.warn("Skipping data with missing group or keyword:", it);
          return; 
        }

        if (!gData[g]) gData[g] = {};
        if (!gData[g][k]) gData[g][k] = new Array(count).fill(NaN);
        const idx = weeks.indexOf(w);
        if (idx > -1) {
          gData[g][k][idx] = v;
        }
      });

      const sorted = {};
      Object.keys(gData).sort().forEach(gName => {
        const kwMap = gData[gName];
        const sortedKwMap = {};
        Object.keys(kwMap).sort().forEach(kName => {
          sortedKwMap[kName] = kwMap[kName];
        });
        sorted[gName] = sortedKwMap;
      });
      console.log("[DEBUG] processLongRows output:", { weeks, groups: sorted }); 
      return { weeks, groups: sorted };
    }

    /***************************************************************
     * B. 解析 气温 CSV
     ***************************************************************/
    function fetchTempCSV(url) {
      return parseCSVWithRetry(url, 3);
    }

    function convertTempData(raw2D) {
      const map = {};
      for (let r = 1; r < raw2D.length; r++) {
        const row = raw2D[r];
        if (!row || !row[0]) continue;
        const wk = row[0];
        
        const rawStr = (row[1] || "").trim();
        let val = NaN;
        if (rawStr) {
          val = parseFloat(rawStr.replace(/,/g, ''));
        }
        map[wk] = val;
      }
      return map;
    }

    /***************************************************************
     * C. createChart() (Y轴为搜索量, 不反转)
     ***************************************************************/
    function createChart(weeks, dsList) {
      const ctx = document.getElementById("myChart").getContext("2d");
      if (chart) chart.destroy();

      const datasets = [...dsList];

      datasets.push({
        label: "平均气温",
        data: tempAvgData,
        borderColor: "rgba(0,0,255,0.7)",
        borderWidth: 2,
        borderDash: [6, 3],
        fill: false,
        tension: 0.1,
        pointRadius: 0,
        pointHoverRadius: 6,
        yAxisID: "y2"
      });
      datasets.push({
        label: "最高气温",
        data: tempMaxData,
        borderColor: "rgba(255,0,0,0.7)",
        borderWidth: 2,
        borderDash: [6, 3],
        fill: false,
        tension: 0.1,
        pointRadius: 0,
        pointHoverRadius: 6,
        yAxisID: "y2"
      });

      chart = new Chart(ctx, {
        type: "line",
        data: { labels: weeks, datasets: datasets },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: { mode: 'index', intersect: false },
          scales: {
            x: { title: { display: true, text: "周" } },
            y: {
              reverse: false, 
              title: { display: true, text: "关键词搜索量(数值大→上)" }
           A },
            y2: {
              type: "linear",
              position: "right",
              reverse: false,
              title: { display: true, text: "气温(℃)" },
              grid: { drawOnChartArea: false }
            }
          },
          plugins: {
            legend: { labels: { font: { size: 16 } } },
            tooltip: {
              titleFont: { size: 16 },
              bodyFont: { size: 16 },
              callbacks: {
                label: function (context) {
                  const val = context.parsed.y;
                    if (isNaN(val)) {
                        return context.dataset.label + ": (无数据)";
                    }
                  let str = context.dataset.label + ": " + val.toLocaleString(); 
                  if (context.dataset.yAxisID === "y2") {
                    str += "°C";
                  }
                  const yoyIdx = context.dataIndex - 52;
                  if (yoyIdx >= 0) {
                    const yoyVal = context.dataset.data[yoyIdx];
                    if (!isNaN(yoyVal)) {
                        if (context.dataset.yAxisID === "y2") {
                          str += " (去年: " + yoyVal.toFixed(2) + "°C)";
                        } else {
                            str += " (去年: " + yoyVal.toLocaleString() + ")";
                        }
                    }
                  }
                  return str;
                }
              }
            }
          }
        }
      });
    }

    /***************************************************************
     * D. 侧边栏 (按搜索量 *降序* 排序)
     ***************************************************************/
    function getLatestValue(arr) {
      if (!arr || arr.length === 0) return NaN;
      for (let i = arr.length - 1; i >= 0; i--) {
        if (!isNaN(arr[i])) {
            return arr[i];
        }
      }
      return NaN;
    }

    function renderGroupSidebar(gData) {
      const container = document.getElementById("groupContainer");
      const noMatchMsg = document.getElementById("noMatchMsg");
      container.innerHTML = "";
      noMatchMsg.style.display = "none";

      let totalGroups = 0;
      if (!gData || Object.keys(gData).length === 0) {
        console.warn("renderGroupSidebar: 传入的 gData 为空。");
        noMatchMsg.style.display = "";
        return;
      }

      Object.keys(gData).forEach(grp => {
        totalGroups++;
        const details = document.createElement("details");
        details.className = "group-panel";

        const summary = document.createElement("summary");
        summary.textContent = grp;

        const allBtn = document.createElement("button");
        allBtn.textContent = "全选";
        allBtn.addEventListener("click", (e) => {
          e.stopPropagation();
          setGroupCheck(grp, true);
        });
        summary.appendChild(allBtn);

        const noneBtn = document.createElement("button");
        noneBtn.textContent = "全不选";
        noneBtn.addEventListener("click", (e) => {
          e.stopPropagation();
          setGroupCheck(grp, false);
        });
        summary.appendChild(noneBtn);

        details.appendChild(summary);

        const kwMap = gData[grp];
        if (!kwMap) return; 

        let kwArray = Object.keys(kwMap).map(kw => {
          const arr = kwMap[kw];
          const latestVal = getLatestValue(arr);
          return { kw, latestVal, arr };
        });
        kwArray.sort((a, b) => {
          const A = a.latestVal, B = b.latestVal;
          const isANaN = isNaN(A), isBNaN = isNaN(B);
          if (isANaN && isBNaN) return a.kw.localeCompare(b.kw);
          if (isANaN) return 1;
          if (isBNaN) return -1;
          return B - A; // 降序排序
        });

        kwArray.forEach(obj => {
          const lb = document.createElement("label");
          const cb = document.createElement("input");
          cb.type = "checkbox";
          cb.checked = true;
          cb.dataset.group = grp;
          cb.dataset.keyword = obj.kw;
          let lastStr = "";
          if (!isNaN(obj.latestVal)) {
            lastStr = " (" + obj.latestVal.toLocaleString() + ")"; 
          }
          lb.appendChild(cb);
          lb.append(" " + obj.kw + lastStr);
          details.appendChild(lb);
        });

        container.appendChild(details);
      });

      if (totalGroups === 0) {
        noMatchMsg.style.display = "";
      }

      container.addEventListener("change", (e) => {
        if (e.target.type === "checkbox") updateVisibleLines();
      });
    }

    /***************************************************************
     * D2. 搜索
     ***************************************************************/
    function applySearchFilter(term) {
      const noMatchMsg = document.getElementById("noMatchMsg");
      noMatchMsg.style.display = "none";

      const s = term.trim().toLowerCase();
      let visibleCount = 0;

      const groupPanels = document.querySelectorAll(".group-panel");
      groupPanels.forEach(panel => {
        const summary = panel.querySelector("summary");
        if (!summary) return;
        const grpName = summary.childNodes[0].textContent;
        const grpLower = grpName.toLowerCase();
        const labels = panel.querySelectorAll("label");

        let groupMatched = s.length > 0 && grpLower.includes(s);
        let matchedKw = 0;

        labels.forEach(lb => {
          const txt = lb.textContent.toLowerCase();
          if (s.length === 0 || groupMatched || txt.includes(s)) {
            lb.style.display = "";
            matchedKw++;
          } else {
            lb.style.display = "none";
          }
        });

        if (s.length === 0) {
          panel.style.display = "";
          visibleCount++;
        } else {
          if (groupMatched || matchedKw > 0) {
            panel.style.display = "";
            visibleCount++;
          } else {
            panel.style.display = "none";
          }
        }
      });

      if (visibleCount === 0) {
        noMatchMsg.style.display = "";
      }
  A }

    /***************************************************************
     * E. updateVisibleLines
     ***************************************************************/
    function updateVisibleLines() {
      const cbs = document.querySelectorAll(`#groupContainer input[type='checkbox']:checked`);
      const dsList = [];
      const colorList = [
        "#e6194b", "#3cb44b", "#ffe119", "#0082c8", "#f58231", "#911eb4", "#46f0f0",
        "#f032e6", "#d2f53c", "#fabebe", "#008080", "#e6beff", "#aa6e28", "#fffac8",
        "#800000", "#aaffc3", "#808080", "#ffd8b1", "#000080", "#808080", "#000000"
      ];
      let idx = 0;
      cbs.forEach(cb => {
        const grp = cb.dataset.group;
        const kw = cb.dataset.keyword;
        if (globalGroupsRaw[grp] && globalGroupsRaw[grp][kw]) {
          const arr = globalGroupsRaw[grp][kw];
          dsList.push({
            label: grp + "/" + kw,
            data: arr,
            borderColor: colorList[idx % colorList.length],
            fill: false,
            tension: 0.1,
            pointRadius: 2,
            pointHoverRadius: 6,
            yAxisID: "y"
          });
          idx++;
        }
      });
      createChart(labelsAll, dsList);
    }

    /***************************************************************
     * E2. setGroupCheck
     ***************************************************************/
    function setGroupCheck(groupName, isCheck) {
      const cbs = document.querySelectorAll(`#groupContainer input[data-group="${groupName}"]`);
      cbs.forEach(cb => cb.checked = isCheck);
      updateVisibleLines();
    }

    /***************************************************************
     * F. 全局 全选/全不选
     ***************************************************************/
    function setAllCheck(isCheck) {
      const cbs = document.querySelectorAll(`#groupContainer input[type='checkbox']`);
      cbs.forEach(cb => cb.checked = isCheck);
      updateVisibleLines();
    }

    /***************************************************************
     * G. 时间筛选
     ***************************************************************/
    function displayWeekName(orig) {
      return orig.replace("_Week_", " W");
    }
    function filterDataRange(startIdx, endIdx) {
      const cbs = document.querySelectorAll(`#groupContainer input[type='checkbox']:checked`);
      const dsList = [];
      const colorList = [
        "#e6194b", "#3cb44b", "#ffe119", "#0082c8", "#f58231", "#911eb4", "#46f0f0",
        "#f032e6", "#d2f53c", "#fabebe", "#008080", "#e6beff", "#aa6e28", "#fffac8",
        "#800000", "#aaffc3", "#808080", "#ffd8b1", "#000080", "#808080", "#000000"
      ];
      let i = 0;
      cbs.forEach(cb => {
        const grp = cb.dataset.group;
        const kw = cb.dataset.keyword;
        
        if (globalGroupsRaw[grp] && globalGroupsRaw[grp][kw]) {
          const fullData = globalGroupsRaw[grp][kw];
          const sliced = fullData.slice(startIdx, endIdx + 1);
          dsList.push({
            label: grp + "/" + kw,
CH         data: sliced,
            borderColor: colorList[i % colorList.length],
            fill: false,
            tension: 0.1,
            pointRadius: 2,
            pointHoverRadius: 6,
            yAxisID: "y"
          });
          i++;
        }
      });
      const slicedWeeks = labelsAll.slice(startIdx, endIdx + 1);
      const slicedAvg = tempAvgData.slice(startIdx, endIdx + 1);
      const slicedMax = tempMaxData.slice(startIdx, endIdx + 1);
      createChart2(slicedWeeks, dsList, slicedAvg, slicedMax);
    }
    function createChart2(weeks, dsList, slicedAvg, slicedMax) {
      if (chart) chart.destroy();

      const datasets = [...dsList];

      datasets.push({
        label: "平均气温",
        data: slicedAvg,
        borderColor: "rgba(0,0,255,0.7)",
        borderWidth: 2,
        borderDash: [6, 3],
        fill: false,
        tension: 0.1,
        pointRadius: 0,
        pointHoverRadius: 6,
        yAxisID: "y2"
      });
      datasets.push({
        label: "最高气温",
        data: slicedMax,
        borderColor: "rgba(255,0,0,0.7)",
        borderWidth: 2,
        borderDash: [6, 3],
        fill: false,
        tension: 0.1,
        pointRadius: 0,
        pointHoverRadius: 6,
        yAxisID: "y2"
      });

      const ctx = document.getElementById("myChart").getContext("2d");
      chart = new Chart(ctx, {
        type: "line",
        data: { labels: weeks, datasets: datasets },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: { mode: 'index', intersect: false },
          scales: {
            x: { title: { display: true, text: "周" } },
            y: {
              reverse: false, 
              title: { display: true, text: "关键词搜索量(数值大→上)" }
            },
            y2: {
              position: "right",
              reverse: false,
              title: { display: true, text: "气温(℃)" },
              grid: { drawOnChartArea: false }
            }
          },
          plugins: {
            legend: { labels: { font: { size: 16 } } },
            tooltip: {
              titleFont: { size: 16 },
              bodyFont: { size: 16 },
              callbacks: {
                label: function (context) {
                  const val = context.parsed.y;
                    if (isNaN(val)) {
                        return context.dataset.label + ": (无数据)";
                    }
                  let str = context.dataset.label + ": " + val.toLocaleString(); 
                  if (context.dataset.yAxisID === "y2") {
CH               str += "°C";
                  }
                  const yoyIdx = context.dataIndex - 52;
                  if (yoyIdx >= 0) {
                    const yoyVal = context.dataset.data[yoyIdx];
                    if (!isNaN(yoyVal)) {
                        if (context.dataset.yAxisID === "y2") {
                    A     str += " (去年: " + yoyVal.toFixed(2) + "°C)";
                        } else {
                            str += " (去年: " + yoyVal.toLocaleString() + ")";
                        }
                    }
                  }
                  return str;
                }
              }
            }
          }
        }
      });
    }

    /***************************************************************
     * H. 主流程
     ***************************************************************/
    async function main() {
      try {
        // 1) 加载关键词
        const keywordRaw = await parseCSVWithRetry(KEYWORD_CSV_URL, 3);
        if (!keywordRaw || !keywordRaw.data || keywordRaw.data.length < 3) {
            throw new Error("关键词CSV数据不足 (少于3行)");
        }
        const longData = convertWideToLong(keywordRaw.data);
        const { weeks, groups } = processLongRows(longData);
        labelsAll = weeks;
        globalGroupsRaw = groups; 
        groupsData = groups;   A 

        // 2) 加载平均气温
        const avgRaw = await parseCSVWithRetry(AVG_TEMP_CSV_URL, 3);
        const avgMap = convertTempData(avgRaw.data);

        // 3) 加载最高气温
        const maxRaw = await parseCSVWithRetry(MAX_TEMP_CSV_URL, 3);
        const maxMap = convertTempData(maxRaw.data);

        // 4) 对齐气温数据
        tempAvgData = new Array(labelsAll.length).fill(NaN);
        tempMaxData = new Array(labelsAll.length).fill(NaN);
        labelsAll.forEach((wk, i) => {
          if (avgMap[wk] != null) {
            tempAvgData[i] = avgMap[wk];
Two     }
          if (maxMap[wk] != null) {
            tempMaxData[i] = maxMap[wk];
          }
        });

        // 5) 渲染侧边栏
        renderGroupSidebar(groupsData);

        // 6) 初始化下拉
        const startSel = document.getElementById("startWeek");
        const endSel = document.getElementById("endWeek");
        startSel.innerHTML = ""; 
        endSel.innerHTML = ""; 
        weeks.forEach((wk, i) => {
          const opt1 = document.createElement("option");
          opt1.value = i;
          opt1.text = wk.replace("_Week_", " W");
          startSel.appendChild(opt1);

          const opt2 = document.createElement("option");
          opt2.value = i;
          opt2.text = wk.replace("_Week_", " W");
CH       endSel.appendChild(opt2);
        });
        startSel.value = 0;
        endSel.value = weeks.length - 1;

        // 7) 默认全选
        updateVisibleLines();
      } catch (err) {
        console.error("主流程(main)失败:", err);
        alert("关键数据加载或解析失败，请检查CSV链接或数据格式后刷新重试。\n" + err.message);
      }
Z   }

    /***************************************************************
     * K. 事件绑定
     ***************************************************************/
    document.getElementById("toggleSidebar").addEventListener("click", () => {
      document.getElementById("sidebar").classList.toggle("active");
    });
    document.getElementById("btnRefresh").addEventListener("click", () => {
      if (chart) chart.destroy();
      const ctx = document.getElementById("myChart").getContext("2d");
      ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
      ctx.font = "16px Arial";
      ctx.fillStyle = "#333";
      ctx.fillText("正在刷新数据，请稍候...", 30, 50);
      main();
    });
    document.getElementById("btnFilter").addEventListener("click", () => {
      const s = parseInt(document.getElementById("startWeek").value);
A     const e = parseInt(document.getElementById("endWeek").value);
      const startIdx = Math.min(s, e);
      const endIdx = Math.max(s, e);
      filterDataRange(startIdx, endIdx);
    });
    document.getElementById("globalAllBtn").addEventListener("click", () => {
      setAllCheck(true);
    });
    document.getElementById("globalNoneBtn").addEventListener("click", () => {
      setAllCheck(false);
    });
    // 搜索相关
    document.getElementById("searchInput").addEventListener("input", (e) => {
      applySearchFilter(e.target.value);
    });
    document.getElementById("btnClearSearch").addEventListener("click", () => {
      const inp = document.getElementById("searchInput");
      inp.value = "";
      applySearchFilter("");
    });

    document.addEventListener("DOMContentLoaded", () => {
      main();
    });
  </script>
</body>
</html>

